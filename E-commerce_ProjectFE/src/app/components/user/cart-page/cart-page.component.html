<div class="cart-container">
  
  <div class="my-orders-section">
    <button class="my-orders-btn" (click)="navigateToOrders()">
      <i class="fas fa-list-alt"></i> My Orders
    </button>
  </div>

  <div class="cart-content">
    
    <div class="cart-items-section">
      <div class="cart-header">
        <h2>Shopping Cart</h2>
        <span class="item-count">{{ totalItemsCount }} Items</span>
      </div>

      
      <div *ngIf="isLoading" class="loading-state">
        <p>Loading cart items...</p>
      </div>

      
      <div class="column-headers" *ngIf="!isLoading && cartItems.length > 0">
        <div class="product-header">PRODUCT DETAILS</div>
        <div class="quantity-header">QUANTITY</div>
        <div class="price-header">PRICE</div>
        <div class="total-header">TOTAL</div>
      </div>

      
      <div class="cart-items-list" *ngIf="!isLoading">
        <div *ngIf="cartItems && cartItems.length > 0; else emptyCart">
          <div *ngFor="let item of cartItems" class="cart-item">
            
            <div class="product-details">
              <img [src]="item.product.productImageURL" [alt]="item.product.productName" class="product-image">
              <div class="product-info">
                <h3>{{ item.product.productName }}</h3>
                <p class="product-category">{{ item.product.productDescription }}</p>
            
                
                <div class="product-meta">
                  <div class="id-badges">
                    <span class="id-badge cart-id">
                      <i class="fas fa-shopping-cart"></i>
                      Cart ID : {{ item.cartItemId }}
                    </span>
                    <span class="id-badge product-id">
                      <i class="fas fa-box"></i>
                      Product ID : {{ item.product.productId }}
                    </span>
                  </div>
                </div>
            
                <button class="remove-btn" (click)="deleteCartItem(item.cartItemId)">
                  <i class="fas fa-trash-alt"></i> Remove
                </button>
              </div>
            </div>
            
            <div class="quantity-controls">
              <button class="qty-btn minus" (click)="decreaseQuantity(item)">âˆ’</button>
              <span class="qty-display">{{ item.productQuantity }}</span>
              <button class="qty-btn plus" (click)="increaseQuantity(item)">+</button>
            </div>
            <div class="item-price">{{ item.product.productPrice | currency:'INR':'symbol':'1.2-2' }}</div>
            <div class="item-total">{{ item.totalPrice | currency:'INR':'symbol':'1.2-2' }}</div>
            <div class="item-selection">
              <label>
                <input type="checkbox" (change)="toggleSelection(item, $event)">
                Select
              </label>
            </div>
          </div>
        </div>
      </div>

      
      <ng-template #emptyCart>
        <div class="empty-cart-message">
          <p>Your cart is empty ðŸ˜•</p>
        </div>
      </ng-template>

      
      <div class="continue-shopping" *ngIf="!isLoading && cartItems.length > 0">
        <button class="continue-btn" (click)="goToHome()">
          <i class="fas fa-arrow-left" ></i> Continue Shopping
        </button>
      </div>
    </div>

    
    <div class="order-summary" *ngIf="!isLoading && cartItems.length > 0">
      <h3>Order Summary</h3>
      
      <div class="summary-row">
        <span>ITEMS {{ selectedItemsCount > 0 ? selectedItemsCount : totalItemsCount }}</span>
        <span>{{ (selectedItemsCount > 0 ? selectedItemsTotal : totalPrice) | currency:'INR':'symbol':'1.2-2' }}</span>
      </div>

      <div class="summary-row">
        <span>SHIPPING</span>
        <span>{{ shippingCost | currency:'INR':'symbol':'1.2-2' }}</span>
      </div>

      
      <div class="address-section" *ngIf="selectedItems.length > 0">
        <div class="summary-row">
          <span>SHIPPING ADDRESS</span>
          <button class="add-new-btn" (click)="toggleAddAddressForm()" type="button">
            <i class="fas fa-plus"></i> Add New
          </button>
        </div>
        
        <!-- Address Selection Dropdown -->
        <div class="address-dropdown" *ngIf="!showAddAddressForm">
          <select class="form-control" [(ngModel)]="selectedAddressId">
            <option value="">-- Select an address --</option>
            <option *ngFor="let address of userAddresses" [value]="address.addressId">
              {{ address.fullAddress }}
            </option>
          </select>
        </div>

        <!-- Add New Address Form -->
        <div class="add-form-section" *ngIf="showAddAddressForm">
          <div class="form-group">
            <input 
              type="text" 
              class="form-input" 
              [(ngModel)]="newAddress" 
              placeholder="Enter complete address" 
            />
          </div>
          <div class="form-actions">
            <button class="form-submit-btn" (click)="addNewAddress()">
              <i class="fas fa-plus"></i> Add Address
            </button>
            <button class="form-cancel-btn" (click)="toggleAddAddressForm()">
              <i class="fas fa-times"></i> Cancel
            </button>
          </div>
        </div>
      </div>

      <div class="shipping-section">
        <div class="summary-row">
          <span>SHIPPING</span>
        </div>
        <div class="shipping-option">
          <select class="shipping-select" (change)="onShippingChange($event)">
            <option value="5">Standard Delivery - â‚¹5.00</option>
            <option value="10">Express Delivery - â‚¹10.00</option>
            <option value="15">Overnight Delivery - â‚¹15.00</option>
          </select>
        </div>
      </div>

      
      <div class="payment-section" *ngIf="selectedAddressId">
        <div class="summary-row">
          <span>PAYMENT OPTIONS</span>
        </div>
        
        <!-- Payment Options -->
        <div class="payment-options">
          <div class="payment-option" 
               [class.selected]="paymentOption === 'PAY_NOW'"
               (click)="selectPaymentOption('PAY_NOW')">
            <div class="option-content">
              <div class="option-icon">ðŸ’³</div>
              <div class="option-details">
                <h4>Pay Now</h4>
                <p>Complete payment online (Card/UPI/Net Banking)</p>
                <span class="status-badge paid">Payment: PAID</span>
              </div>
              <div class="option-radio">
                <input type="radio" 
                       name="paymentOption" 
                       value="PAY_NOW"
                       [checked]="paymentOption === 'PAY_NOW'"
                       (change)="selectPaymentOption('PAY_NOW')">
              </div>
            </div>
          </div>

          <div class="payment-option" 
               [class.selected]="paymentOption === 'CASH_ON_DELIVERY'"
               (click)="selectPaymentOption('CASH_ON_DELIVERY')">
            <div class="option-content">
              <div class="option-icon">ðŸ’µ</div>
              <div class="option-details">
                <h4>Cash on Delivery</h4>
                <p>Pay when your order is delivered</p>
                <span class="status-badge pending">Payment: PENDING</span>
              </div>
              <div class="option-radio">
                <input type="radio" 
                       name="paymentOption" 
                       value="CASH_ON_DELIVERY"
                       [checked]="paymentOption === 'CASH_ON_DELIVERY'"
                       (change)="selectPaymentOption('CASH_ON_DELIVERY')">
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="total-section">
        <div class="summary-row total-row">
          <span>TOTAL COST</span>
          <span>{{ (selectedItemsCount > 0 ? getFinalTotal() : getAllItemsTotal()) | currency:'INR':'symbol':'1.2-2' }}</span>
        </div>
      </div>
      <button class="checkout-btn" 
              (click)="placeOrder()" 
              [disabled]="!selectedAddressId || selectedItems.length === 0">
        CHECKOUT
      </button>
    </div>
  </div>
</div>